lm2$coefficients[2]
lm2$coefficients[3]
quadfit = lm2$coefficients[1] + lm2$coefficients[2]*xnew + lm2$coefficients[3]*xnew^2
lines(xnew,quadfit,col=2,lwd=3)
quadfit
## Bootstrapping example
library(mosaic)
creatinine = read.csv("../data/creatinine.csv", header=TRUE)
head(creatinine)
plot(creatinine$age,creatinine$creatclear)
# Look at the mean creatinine clearance rate
mean(creatinine$creatclear)
resample(creatinine)
resample(creatinine)
resample(creatinine)
resample(creatinine)
resample(creatinine)
resample(creatinine)
resample(creatinine)
resample(creatinine)
resample(creatinine)
resample(creatinine)
resample(creatinine)
resample(creatinine)
mean(resample(creatinine)$creatclear)
mean(resample(creatinine)$creatclear)
mean(resample(creatinine)$creatclear)
mean(resample(creatinine)$creatclear)
mean(resample(creatinine)$creatclear)
mean(resample(creatinine)$creatclear)
mean(resample(creatinine)$creatclear)
mean(resample(creatinine)$creatclear)
mean(resample(creatinine)$creatclear)
mean(resample(creatinine)$creatclear)
mean(resample(creatinine)$creatclear)
mean(resample(creatinine)$creatclear)
mean(resample(creatinine)$creatclear)
mean(resample(creatinine)$creatclear)
mean(resample(creatinine)$creatclear)
mean(resample(creatinine)$creatclear)
mean(resample(creatinine)$creatclear)
mean(resample(creatinine)$creatclear)
mean(resample(creatinine)$creatclear)
mean(resample(creatinine)$creatclear)
mean(resample(creatinine)$creatclear)
mean(resample(creatinine)$creatclear)
mean(resample(creatinine)$creatclear)
mean(resample(creatinine)$creatclear)
mean(resample(creatinine)$creatclear)
mean(resample(creatinine)$creatclear)
boot1 = do(10000)*{
mean(resample(creatinine)$creatclear)
}
hist(boot1$result, 30)
sd(boot1$result)
confint(boot1, level=0.95)
plot(creatclear~age, data=creatinine,
pch=19, col='grey', bty='n',
ylab="creatinine score", xlab="Age")
hist(boot1$result, 30)
boot1
head(boot1)
plot(creatclear~age, data=creatinine,
pch=19, col='grey', bty='n',
ylab="creatinine score", xlab="Age")
lm1 = lm(creatclear~age, data=creatinine)
abline(lm1, lwd=2, col='blue')
coef(lm1)
boot1 = do(10000)*lm(creatclear~age, data=resample(creatinine))
head(boot1)
hist(boot1$Intercept)
hist(boot1$age)
sd(boot1$Intercept)
sd(boot1$age)
summary(lm1)
KHOU_squared = load_combined$KHOU^2
load_combined$KHOU_squared = KHOU_squared
numboot = 200
lm2 = do(numboot)*(lm(COAST ~ KHOU + KHOU_squared, data=resample(load_combined)))
plot(load_combined$KHOU,load_combined$COAST,col=rgb(0,0,0,alpha=0.1),pch=19,cex=0.8)
x = load_combined$KHOU
xmin = floor(min(x))
xmax = floor(max(x))
xnew = seq(xmin,xmax,length.out=500)
quadfit = array(NA,c(numboot,length(xnew)))
for(ii in 1:numboot){
quadfit[ii,] = lm2$Intercept[ii] + lm2$KHOU[ii]*xnew +   lm2$KHOU_squared[ii]*xnew^2
lines(xnew,quadfit[ii,],col=rgb(1,0,0,alpha=0.3),lwd=1)
}
# smaller sample
load_combined_small = sample(load_combined,500)
KHOU_squared = load_combined_small$KHOU^2
load_combined_small$KHOU_squared = KHOU_squared
numboot = 200
lm2 = do(numboot)*(lm(COAST ~ KHOU + KHOU_squared, data=resample(load_combined_small)))
plot(load_combined_small$KHOU,load_combined_small$COAST,col=rgb(0,0,0,alpha=0.1),pch=19,cex=0.8)
x = load_combined_small$KHOU
xmin = floor(min(x))
xmax = floor(max(x))
xnew = seq(xmin,xmax,length.out=500)
quadfit = array(NA,c(numboot,length(xnew)))
for(ii in 1:numboot){
quadfit[ii,] = lm2$Intercept[ii] + lm2$KHOU[ii]*xnew +   lm2$KHOU_squared[ii]*xnew^2
lines(xnew,quadfit[ii,],col=rgb(1,0,0,alpha=0.3),lwd=1)
}
quadfit = array(NA,c(numboot,length(xnew)))
dim(quadfit)
# smaller sample
load_combined_small = sample(load_combined,50)
KHOU_squared = load_combined_small$KHOU^2
load_combined_small$KHOU_squared = KHOU_squared
numboot = 200
lm2 = do(numboot)*(lm(COAST ~ KHOU + KHOU_squared, data=resample(load_combined_small)))
plot(load_combined_small$KHOU,load_combined_small$COAST,col=rgb(0,0,0,alpha=0.1),pch=19,cex=0.8)
x = load_combined_small$KHOU
xmin = floor(min(x))
xmax = floor(max(x))
xnew = seq(xmin,xmax,length.out=500)
quadfit = array(NA,c(numboot,length(xnew)))
for(ii in 1:numboot){
quadfit[ii,] = lm2$Intercept[ii] + lm2$KHOU[ii]*xnew +   lm2$KHOU_squared[ii]*xnew^2
lines(xnew,quadfit[ii,],col=rgb(1,0,0,alpha=0.3),lwd=1)
}
# smaller sample
load_combined_small = sample(load_combined,50)
KHOU_squared = load_combined_small$KHOU^2
load_combined_small$KHOU_squared = KHOU_squared
numboot = 200
lm2 = do(numboot)*(lm(COAST ~ KHOU + KHOU_squared, data=resample(load_combined_small)))
plot(load_combined_small$KHOU,load_combined_small$COAST,col=rgb(0,0,0,alpha=0.1),pch=19,cex=0.8)
x = load_combined_small$KHOU
xmin = floor(min(x))
xmax = floor(max(x))
xnew = seq(xmin,xmax,length.out=500)
quadfit = array(NA,c(numboot,length(xnew)))
for(ii in 1:numboot){
quadfit[ii,] = lm2$Intercept[ii] + lm2$KHOU[ii]*xnew +   lm2$KHOU_squared[ii]*xnew^2
lines(xnew,quadfit[ii,],col=rgb(1,0,0,alpha=0.3),lwd=1)
}
# smaller sample
load_combined_small = sample(load_combined,50)
KHOU_squared = load_combined_small$KHOU^2
load_combined_small$KHOU_squared = KHOU_squared
numboot = 200
lm2 = do(numboot)*(lm(COAST ~ KHOU + KHOU_squared, data=resample(load_combined_small)))
plot(load_combined_small$KHOU,load_combined_small$COAST,col=rgb(0,0,0,alpha=0.1),pch=19,cex=0.8)
x = load_combined_small$KHOU
xmin = floor(min(x))
xmax = floor(max(x))
xnew = seq(xmin,xmax,length.out=500)
quadfit = array(NA,c(numboot,length(xnew)))
for(ii in 1:numboot){
quadfit[ii,] = lm2$Intercept[ii] + lm2$KHOU[ii]*xnew +   lm2$KHOU_squared[ii]*xnew^2
lines(xnew,quadfit[ii,],col=rgb(1,0,0,alpha=0.3),lwd=1)
}
minwageNJ$fullPropAfter <- minwageNJ$fullAfter /
(minwageNJ$fullAfter + minwageNJ$partAfter)
minwagePA$fullPropAfter <- minwagePA$fullAfter /
(minwagePA$fullAfter + minwagePA$partAfter)
head(minwage)
NJdiff <- mean(minwageNJ$fullPropAfter) - mean(minwageNJ$fullPropBefore)
NJdiff
minwagePA$fullPropBefore <- minwagePA$fullBefore /
(minwagePA$fullBefore + minwagePA$partBefore)
PAdiff <- mean(minwagePA$fullPropAfter) - mean(minwagePA$fullPropBefore)
NJdiff - PAdiff
minwageNJ$fullPropBefore
# diff in diff example with minimum wage data
minwage <- read.csv("../data/minwage.csv") # load the data
minwageNJ <- subset(minwage, subset = (location != "PA"))
minwagePA <- subset(minwage, subset = (location == "PA"))
minwage
head(minwage)
minwageNJ <- subset(minwage, subset = (location != "PA"))
minwagePA <- subset(minwage, subset = (location == "PA"))
mean(minwageNJ$fullPropBefore)
minwageNJ$fullPropAfter <- minwageNJ$fullAfter /
(minwageNJ$fullAfter + minwageNJ$partAfter)
minwagePA$fullPropAfter <- minwagePA$fullAfter /
(minwagePA$fullAfter + minwagePA$partAfter)
# diffindiff estimate
NJdiff <- mean(minwageNJ$fullPropAfter) - mean(minwageNJ$fullPropBefore)
# diff in diff example with minimum wage data
minwage <- read.csv("../data/minwage.csv") # load the data
minwageNJ <- subset(minwage, subset = (location != "PA"))
minwagePA <- subset(minwage, subset = (location == "PA"))
# defining outcome of interest
minwageNJ$fullPropAfter <- minwageNJ$fullAfter /
(minwageNJ$fullAfter + minwageNJ$partAfter)
minwagePA$fullPropAfter <- minwagePA$fullAfter /
(minwagePA$fullAfter + minwagePA$partAfter)
minwageNJ$fullPropBefore <- minwageNJ$fullBefore /
(minwageNJ$fullBefore + minwageNJ$partBefore)
minwagePA$fullPropBefore <- minwagePA$fullBefore /
(minwagePA$fullBefore + minwagePA$partBefore)
# diffindiff estimate
NJdiff <- mean(minwageNJ$fullPropAfter) - mean(minwageNJ$fullPropBefore)
minwagePA$fullPropBefore <- minwagePA$fullBefore /
(minwagePA$fullBefore + minwagePA$partBefore)
PAdiff <- mean(minwagePA$fullPropAfter) - mean(minwagePA$fullPropBefore)
NJdiff - PAdiff
minwage_big = rbind(minwage,minwage)
minwage_big$time = rep(NA,nrow(minwage_big))
head(minwage_big)
minwage_big$time[1:nrow(minwage)] = "before"
minwage_big$time[1:nrow(minwage)] = "Before"
minwage_big$time[(nrow(minwage)+1):nrow(minwage_big)] = "After"
minwage_big$wageBefore[which(minwage_big$time=="After")] <- NA
minwage_big$fullBefore[which(minwage_big$time=="After")] <- NA
minwage_big$partBefore[which(minwage_big$time=="After")] <- NA
minwage_big$wageAfter[which(minwage_big$time=="Before")] <- NA
minwage_big$fullAfter[which(minwage_big$time=="Before")] <- NA
minwage_big$partAfter[which(minwage_big$time=="Before")] <- NA
head(minwage_big)
minwage_big$fullPropBefore = minwage_big$fullBefore /
(minwage_big$fullBefore + minwage_big$partBefore)
head(minwage_big)
minwage_big$fullPropAfter = minwage_big$fullAfter /
(minwage_big$fullAfter + minwage_big$partAfter)
fit = lm()
minwage_big$fullPropAfter = minwage_big$fullAfter /
(minwage_big$fullAfter + minwage_big$partAfter)
head(minwage_big)
# diff in diff example with minimum wage data
minwage <- read.csv("../data/minwage.csv") # load the data
minwageNJ <- subset(minwage, subset = (location != "PA"))
minwagePA <- subset(minwage, subset = (location == "PA"))
# defining outcome of interest
minwageNJ$fullPropAfter <- minwageNJ$fullAfter /
(minwageNJ$fullAfter + minwageNJ$partAfter)
minwagePA$fullPropAfter <- minwagePA$fullAfter /
(minwagePA$fullAfter + minwagePA$partAfter)
minwageNJ$fullPropBefore <- minwageNJ$fullBefore /
(minwageNJ$fullBefore + minwageNJ$partBefore)
minwagePA$fullPropBefore <- minwagePA$fullBefore /
(minwagePA$fullBefore + minwagePA$partBefore)
# diffindiff estimate
NJdiff <- mean(minwageNJ$fullPropAfter) - mean(minwageNJ$fullPropBefore)
minwagePA$fullPropBefore <- minwagePA$fullBefore /
(minwagePA$fullBefore + minwagePA$partBefore)
PAdiff <- mean(minwagePA$fullPropAfter) - mean(minwagePA$fullPropBefore)
NJdiff - PAdiff
# adding a binary variable to our data set
minwage_big = rbind(minwage,minwage)
minwage_big$time = rep(NA,nrow(minwage_big))
minwage_big$time[1:nrow(minwage)] = "Before"
minwage_big$time[(nrow(minwage)+1):nrow(minwage_big)] = "After"
minwage_big$wageBefore[which(minwage_big$time=="After")] <- NA
minwage_big$fullBefore[which(minwage_big$time=="After")] <- NA
minwage_big$partBefore[which(minwage_big$time=="After")] <- NA
minwage_big$wageAfter[which(minwage_big$time=="Before")] <- NA
minwage_big$fullAfter[which(minwage_big$time=="Before")] <- NA
minwage_big$partAfter[which(minwage_big$time=="Before")] <- NA
head(minwage_big)
minwage_big$fullPropBefore = minwage_big$fullBefore /
(minwage_big$fullBefore + minwage_big$partBefore)
minwage_big$fullPropAfter = minwage_big$fullAfter /
(minwage_big$fullAfter + minwage_big$partAfter)
minwage_big$fullPropBefore[!is.na(minwage_big$fullPropBefore)]
fullProp = cbind(minwage_big$fullPropBefore[!is.na(minwage_big$fullPropBefore)],minwage_big$fullPropAfter[!is.na(minwage_big$fullPropAfter)])
length(fullProp)
sum(is.na(fullProp))
minwage$fullProp = fullProp
head(minwage_big)
minwage_big$fullProp = fullProp
head(minwage_big)
# diff in diff example with minimum wage data
minwage <- read.csv("../data/minwage.csv") # load the data
minwageNJ <- subset(minwage, subset = (location != "PA"))
minwagePA <- subset(minwage, subset = (location == "PA"))
# defining outcome of interest
minwageNJ$fullPropAfter <- minwageNJ$fullAfter /
(minwageNJ$fullAfter + minwageNJ$partAfter)
minwagePA$fullPropAfter <- minwagePA$fullAfter /
(minwagePA$fullAfter + minwagePA$partAfter)
minwageNJ$fullPropBefore <- minwageNJ$fullBefore /
(minwageNJ$fullBefore + minwageNJ$partBefore)
minwagePA$fullPropBefore <- minwagePA$fullBefore /
(minwagePA$fullBefore + minwagePA$partBefore)
# diffindiff estimate
NJdiff <- mean(minwageNJ$fullPropAfter) - mean(minwageNJ$fullPropBefore)
minwagePA$fullPropBefore <- minwagePA$fullBefore /
(minwagePA$fullBefore + minwagePA$partBefore)
PAdiff <- mean(minwagePA$fullPropAfter) - mean(minwagePA$fullPropBefore)
NJdiff - PAdiff
# adding a binary variable to our data set
minwage_big = rbind(minwage,minwage)
minwage_big$time = rep(NA,nrow(minwage_big))
minwage_big$time[1:nrow(minwage)] = "Before"
minwage_big$time[(nrow(minwage)+1):nrow(minwage_big)] = "After"
minwage_big$wageBefore[which(minwage_big$time=="After")] <- NA
minwage_big$fullBefore[which(minwage_big$time=="After")] <- NA
minwage_big$partBefore[which(minwage_big$time=="After")] <- NA
minwage_big$wageAfter[which(minwage_big$time=="Before")] <- NA
minwage_big$fullAfter[which(minwage_big$time=="Before")] <- NA
minwage_big$partAfter[which(minwage_big$time=="Before")] <- NA
head(minwage_big)
# fit a special linear model
minwage_big$fullPropBefore = minwage_big$fullBefore /
(minwage_big$fullBefore + minwage_big$partBefore)
minwage_big$fullPropAfter = minwage_big$fullAfter /
(minwage_big$fullAfter + minwage_big$partAfter)
fullProp = cbind(minwage_big$fullPropBefore[!is.na(minwage_big$fullPropBefore)],minwage_big$fullPropAfter[!is.na(minwage_big$fullPropAfter)])
minwage_big$fullProp = fullProp
# diff in diff example with minimum wage data
minwage <- read.csv("../data/minwage.csv") # load the data
minwageNJ <- subset(minwage, subset = (location != "PA"))
minwagePA <- subset(minwage, subset = (location == "PA"))
# defining outcome of interest
minwageNJ$fullPropAfter <- minwageNJ$fullAfter /
(minwageNJ$fullAfter + minwageNJ$partAfter)
minwagePA$fullPropAfter <- minwagePA$fullAfter /
(minwagePA$fullAfter + minwagePA$partAfter)
minwageNJ$fullPropBefore <- minwageNJ$fullBefore /
(minwageNJ$fullBefore + minwageNJ$partBefore)
minwagePA$fullPropBefore <- minwagePA$fullBefore /
(minwagePA$fullBefore + minwagePA$partBefore)
# diffindiff estimate
NJdiff <- mean(minwageNJ$fullPropAfter) - mean(minwageNJ$fullPropBefore)
minwagePA$fullPropBefore <- minwagePA$fullBefore /
(minwagePA$fullBefore + minwagePA$partBefore)
PAdiff <- mean(minwagePA$fullPropAfter) - mean(minwagePA$fullPropBefore)
NJdiff - PAdiff
# adding a binary variable to our data set
minwage_big = rbind(minwage,minwage)
minwage_big$time = rep(NA,nrow(minwage_big))
minwage_big$time[1:nrow(minwage)] = "Before"
minwage_big$time[(nrow(minwage)+1):nrow(minwage_big)] = "After"
minwage_big$wageBefore[which(minwage_big$time=="After")] <- NA
minwage_big$fullBefore[which(minwage_big$time=="After")] <- NA
minwage_big$partBefore[which(minwage_big$time=="After")] <- NA
minwage_big$wageAfter[which(minwage_big$time=="Before")] <- NA
minwage_big$fullAfter[which(minwage_big$time=="Before")] <- NA
minwage_big$partAfter[which(minwage_big$time=="Before")] <- NA
head(minwage_big)
# fit a special linear model
minwage_big$fullPropBefore = minwage_big$fullBefore /
(minwage_big$fullBefore + minwage_big$partBefore)
minwage_big$fullPropAfter = minwage_big$fullAfter /
(minwage_big$fullAfter + minwage_big$partAfter)
fullProp = rbind(minwage_big$fullPropBefore[!is.na(minwage_big$fullPropBefore)],minwage_big$fullPropAfter[!is.na(minwage_big$fullPropAfter)])
minwage_big$fullProp = fullProp
# diff in diff example with minimum wage data
minwage <- read.csv("../data/minwage.csv") # load the data
minwageNJ <- subset(minwage, subset = (location != "PA"))
minwagePA <- subset(minwage, subset = (location == "PA"))
# defining outcome of interest
minwageNJ$fullPropAfter <- minwageNJ$fullAfter /
(minwageNJ$fullAfter + minwageNJ$partAfter)
minwagePA$fullPropAfter <- minwagePA$fullAfter /
(minwagePA$fullAfter + minwagePA$partAfter)
minwageNJ$fullPropBefore <- minwageNJ$fullBefore /
(minwageNJ$fullBefore + minwageNJ$partBefore)
minwagePA$fullPropBefore <- minwagePA$fullBefore /
(minwagePA$fullBefore + minwagePA$partBefore)
# diffindiff estimate
NJdiff <- mean(minwageNJ$fullPropAfter) - mean(minwageNJ$fullPropBefore)
minwagePA$fullPropBefore <- minwagePA$fullBefore /
(minwagePA$fullBefore + minwagePA$partBefore)
PAdiff <- mean(minwagePA$fullPropAfter) - mean(minwagePA$fullPropBefore)
NJdiff - PAdiff
# adding a binary variable to our data set
minwage_big = rbind(minwage,minwage)
minwage_big$time = rep(NA,nrow(minwage_big))
minwage_big$time[1:nrow(minwage)] = "Before"
minwage_big$time[(nrow(minwage)+1):nrow(minwage_big)] = "After"
minwage_big$wageBefore[which(minwage_big$time=="After")] <- NA
minwage_big$fullBefore[which(minwage_big$time=="After")] <- NA
minwage_big$partBefore[which(minwage_big$time=="After")] <- NA
minwage_big$wageAfter[which(minwage_big$time=="Before")] <- NA
minwage_big$fullAfter[which(minwage_big$time=="Before")] <- NA
minwage_big$partAfter[which(minwage_big$time=="Before")] <- NA
head(minwage_big)
# fit a special linear model
minwage_big$fullPropBefore = minwage_big$fullBefore /
(minwage_big$fullBefore + minwage_big$partBefore)
minwage_big$fullPropAfter = minwage_big$fullAfter /
(minwage_big$fullAfter + minwage_big$partAfter)
fullProp = c(minwage_big$fullPropBefore[!is.na(minwage_big$fullPropBefore)],minwage_big$fullPropAfter[!is.na(minwage_big$fullPropAfter)])
minwage_big$fullProp = fullProp
head(minwage_big)
fit = lm(fullProp~location + time + location*time,data=minwage_big)
summary(fit)
head(minwage_big)
# diff in diff example with minimum wage data
minwage <- read.csv("../data/minwage.csv") # load the data
minwageNJ <- subset(minwage, subset = (location != "PA"))
minwagePA <- subset(minwage, subset = (location == "PA"))
# defining outcome of interest
minwageNJ$fullPropAfter <- minwageNJ$fullAfter /
(minwageNJ$fullAfter + minwageNJ$partAfter)
minwagePA$fullPropAfter <- minwagePA$fullAfter /
(minwagePA$fullAfter + minwagePA$partAfter)
minwageNJ$fullPropBefore <- minwageNJ$fullBefore /
(minwageNJ$fullBefore + minwageNJ$partBefore)
minwagePA$fullPropBefore <- minwagePA$fullBefore /
(minwagePA$fullBefore + minwagePA$partBefore)
# diffindiff estimate
NJdiff <- mean(minwageNJ$fullPropAfter) - mean(minwageNJ$fullPropBefore)
minwagePA$fullPropBefore <- minwagePA$fullBefore /
(minwagePA$fullBefore + minwagePA$partBefore)
PAdiff <- mean(minwagePA$fullPropAfter) - mean(minwagePA$fullPropBefore)
NJdiff - PAdiff
# adding a binary variable to our data set
minwage_big = rbind(minwage,minwage)
minwage_big$time = rep(NA,nrow(minwage_big))
minwage_big$time[1:nrow(minwage)] = "Before"
minwage_big$time[(nrow(minwage)+1):nrow(minwage_big)] = "After"
minwage_big$wageBefore[which(minwage_big$time=="After")] <- NA
minwage_big$fullBefore[which(minwage_big$time=="After")] <- NA
minwage_big$partBefore[which(minwage_big$time=="After")] <- NA
minwage_big$wageAfter[which(minwage_big$time=="Before")] <- NA
minwage_big$fullAfter[which(minwage_big$time=="Before")] <- NA
minwage_big$partAfter[which(minwage_big$time=="Before")] <- NA
head(minwage_big)
# fit a special linear model
minwage_big$fullPropBefore = minwage_big$fullBefore /
(minwage_big$fullBefore + minwage_big$partBefore)
minwage_big$fullPropAfter = minwage_big$fullAfter /
(minwage_big$fullAfter + minwage_big$partAfter)
fullProp = c(minwage_big$fullPropBefore[!is.na(minwage_big$fullPropBefore)],minwage_big$fullPropAfter[!is.na(minwage_big$fullPropAfter)])
minwage_big$fullProp = fullProp
# fix location variable
minwage_big$location[which(minwage_big$location!="PA")] <- NJ
# diff in diff example with minimum wage data
minwage <- read.csv("../data/minwage.csv") # load the data
minwageNJ <- subset(minwage, subset = (location != "PA"))
minwagePA <- subset(minwage, subset = (location == "PA"))
# defining outcome of interest
minwageNJ$fullPropAfter <- minwageNJ$fullAfter /
(minwageNJ$fullAfter + minwageNJ$partAfter)
minwagePA$fullPropAfter <- minwagePA$fullAfter /
(minwagePA$fullAfter + minwagePA$partAfter)
minwageNJ$fullPropBefore <- minwageNJ$fullBefore /
(minwageNJ$fullBefore + minwageNJ$partBefore)
minwagePA$fullPropBefore <- minwagePA$fullBefore /
(minwagePA$fullBefore + minwagePA$partBefore)
# diffindiff estimate
NJdiff <- mean(minwageNJ$fullPropAfter) - mean(minwageNJ$fullPropBefore)
minwagePA$fullPropBefore <- minwagePA$fullBefore /
(minwagePA$fullBefore + minwagePA$partBefore)
PAdiff <- mean(minwagePA$fullPropAfter) - mean(minwagePA$fullPropBefore)
NJdiff - PAdiff
# adding a binary variable to our data set
minwage_big = rbind(minwage,minwage)
minwage_big$time = rep(NA,nrow(minwage_big))
minwage_big$time[1:nrow(minwage)] = "Before"
minwage_big$time[(nrow(minwage)+1):nrow(minwage_big)] = "After"
minwage_big$wageBefore[which(minwage_big$time=="After")] <- NA
minwage_big$fullBefore[which(minwage_big$time=="After")] <- NA
minwage_big$partBefore[which(minwage_big$time=="After")] <- NA
minwage_big$wageAfter[which(minwage_big$time=="Before")] <- NA
minwage_big$fullAfter[which(minwage_big$time=="Before")] <- NA
minwage_big$partAfter[which(minwage_big$time=="Before")] <- NA
head(minwage_big)
# fit a special linear model
minwage_big$fullPropBefore = minwage_big$fullBefore /
(minwage_big$fullBefore + minwage_big$partBefore)
minwage_big$fullPropAfter = minwage_big$fullAfter /
(minwage_big$fullAfter + minwage_big$partAfter)
fullProp = c(minwage_big$fullPropBefore[!is.na(minwage_big$fullPropBefore)],minwage_big$fullPropAfter[!is.na(minwage_big$fullPropAfter)])
minwage_big$fullProp = fullProp
# fix location variable
minwage_big$location[which(minwage_big$location!="PA")] <- "NJ"
# fix location variable
minwage_big$location[which(minwage_big$location!="PA")] <- "NJ"
head(minwage_big)
fit = lm(fullProp ~ location + time + location*time, data=minwage_big)
summary(fit)
# diff in diff example with minimum wage data
minwage <- read.csv("../data/minwage.csv") # load the data
minwageNJ <- subset(minwage, subset = (location != "PA"))
minwagePA <- subset(minwage, subset = (location == "PA"))
# defining outcome of interest
minwageNJ$fullPropAfter <- minwageNJ$fullAfter /
(minwageNJ$fullAfter + minwageNJ$partAfter)
minwagePA$fullPropAfter <- minwagePA$fullAfter /
(minwagePA$fullAfter + minwagePA$partAfter)
minwageNJ$fullPropBefore <- minwageNJ$fullBefore /
(minwageNJ$fullBefore + minwageNJ$partBefore)
minwagePA$fullPropBefore <- minwagePA$fullBefore /
(minwagePA$fullBefore + minwagePA$partBefore)
# diffindiff estimate
NJdiff <- mean(minwageNJ$fullPropAfter) - mean(minwageNJ$fullPropBefore)
minwagePA$fullPropBefore <- minwagePA$fullBefore /
(minwagePA$fullBefore + minwagePA$partBefore)
PAdiff <- mean(minwagePA$fullPropAfter) - mean(minwagePA$fullPropBefore)
NJdiff - PAdiff
# adding a binary variable to our data set
minwage_big = rbind(minwage,minwage)
minwage_big$time = rep(NA,nrow(minwage_big))
minwage_big$time[1:nrow(minwage)] = "Before"
minwage_big$time[(nrow(minwage)+1):nrow(minwage_big)] = "After"
minwage_big$wageBefore[which(minwage_big$time=="After")] <- NA
minwage_big$fullBefore[which(minwage_big$time=="After")] <- NA
minwage_big$partBefore[which(minwage_big$time=="After")] <- NA
minwage_big$wageAfter[which(minwage_big$time=="Before")] <- NA
minwage_big$fullAfter[which(minwage_big$time=="Before")] <- NA
minwage_big$partAfter[which(minwage_big$time=="Before")] <- NA
head(minwage_big)
# fit a special linear model
minwage_big$fullPropBefore = minwage_big$fullBefore /
(minwage_big$fullBefore + minwage_big$partBefore)
minwage_big$fullPropAfter = minwage_big$fullAfter /
(minwage_big$fullAfter + minwage_big$partAfter)
fullProp = c(minwage_big$fullPropBefore[!is.na(minwage_big$fullPropBefore)],minwage_big$fullPropAfter[!is.na(minwage_big$fullPropAfter)])
minwage_big$fullProp = fullProp
# fix location variable
minwage_big$location[which(minwage_big$location!="PA")] <- "NJ"
head(minwage_big)
fit = lm(fullProp ~ location + time + location*time, data=minwage_big)
summary(fit)
